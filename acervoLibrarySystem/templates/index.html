<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sistema de Biblioteca</title>
    <link rel="stylesheet" href="/static/style.css?v=31">
    <style>
        body {
            background: linear-gradient(135deg, #38a169 0%, #2f855a 50%, #276749 100%) !important;
            min-height: 100vh;
            position: relative;
            overflow-x: hidden;
        }
        
        /* Padr√£o de livros decorativos */
        body::before {
            content: '';
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-image: 
                repeating-linear-gradient(45deg, transparent, transparent 35px, rgba(255,255,255,0.03) 35px, rgba(255,255,255,0.03) 70px),
                repeating-linear-gradient(-45deg, transparent, transparent 35px, rgba(255,255,255,0.03) 35px, rgba(255,255,255,0.03) 70px);
            pointer-events: none;
            z-index: 0;
        }
        
        /* Efeito de ondas */
        body::after {
            content: '';
            position: fixed;
            bottom: 0;
            left: 0;
            right: 0;
            height: 40%;
            background: url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1440 320"><path fill="rgba(255,255,255,0.05)" d="M0,96L48,112C96,128,192,160,288,160C384,160,480,128,576,122.7C672,117,768,139,864,138.7C960,139,1056,117,1152,112C1248,107,1344,117,1392,122.7L1440,128L1440,320L1392,320C1344,320,1248,320,1152,320C1056,320,960,320,864,320C768,320,672,320,576,320C480,320,384,320,288,320C192,320,96,320,48,320L0,320Z"></path></svg>') no-repeat bottom;
            background-size: cover;
            pointer-events: none;
            z-index: 0;
        }
        
        /* C√≠rculos decorativos flutuantes */
        @keyframes floatBook {
            0%, 100% {
                transform: translateY(0) translateX(0) rotate(var(--rotation, 0deg));
                opacity: 0.3;
            }
            33% {
                transform: translateY(-20px) translateX(10px) rotate(calc(var(--rotation, 0deg) + 5deg));
                opacity: 0.5;
            }
            66% {
                transform: translateY(-10px) translateX(-10px) rotate(calc(var(--rotation, 0deg) - 5deg));
                opacity: 0.4;
            }
        }
        
        .bg-circle {
            position: fixed;
            background: rgba(0, 0, 0, 0.15);
            border-radius: 4px;
            pointer-events: none;
            z-index: 0;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
            animation: floatBook 15s ease-in-out infinite;
        }
        
        .bg-circle::before {
            content: '';
            position: absolute;
            top: 0;
            left: 5%;
            width: 90%;
            height: 100%;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 2px;
        }
        
        .bg-circle:nth-child(1) {
            width: 120px;
            height: 160px;
            top: 10%;
            left: 8%;
            --rotation: -15deg;
            animation-duration: 20s;
        }
        
        .bg-circle:nth-child(2) {
            width: 100px;
            height: 140px;
            top: 50%;
            right: 10%;
            --rotation: 12deg;
            animation-duration: 16s;
            animation-delay: -6s;
        }
        
        .bg-circle:nth-child(3) {
            width: 110px;
            height: 150px;
            bottom: 15%;
            left: 15%;
            --rotation: -8deg;
            animation-duration: 18s;
            animation-delay: -12s;
        }
        
        .container {
            position: relative;
            z-index: 1;
        }
    </style>
</head>
<body>
    <div class="bg-circle"></div>
    <div class="bg-circle"></div>
    <div class="bg-circle"></div>
    <div class="container">
        <header class="app-header">
            <div class="app-header-text">
                <h1>Sistema de Biblioteca</h1>
            </div>
        </header>
        <div class="tabs">
            <button class="tab-link active" data-tab="add-book">Adicionar Livro</button>
            <button class="tab-link" data-tab="manage-students">Gerenciar Alunos</button>
            <button class="tab-link" data-tab="available-books">Livros Dispon√≠veis</button>
            <button class="tab-link" data-tab="borrowed-books">Livros Emprestados</button>
            <button class="tab-link" data-tab="history">Hist√≥rico</button>
        </div>

        <div id="add-book" class="tab-content active">
            <div style="display: grid; grid-template-columns: 380px 1fr; gap: 1.5rem; align-items: start; max-height: calc(100vh - 180px);">
                <!-- Coluna Esquerda: Formul√°rio de Adicionar Livro -->
                <div class="form-card" style="padding: 1rem;">
                    <h2 style="margin-bottom: 0.8rem; color: #2c5282; font-size: 1.2rem;">üìö Adicionar Novo Livro</h2>
                    <form id="add-book-form">
                        <div class="form-group" style="margin-bottom: 0.6rem;">
                            <label for="add-title" style="font-size: 0.85rem; margin-bottom: 0.25rem; display: block;">T√≠tulo do Livro:</label>
                            <input type="text" id="add-title" required placeholder="Digite o t√≠tulo completo" style="font-size: 0.9rem; padding: 0.5rem;">
                        </div>
                        <div class="form-group" style="margin-bottom: 0.6rem;">
                            <label for="add-author" style="font-size: 0.85rem; margin-bottom: 0.25rem; display: block;">Autor:</label>
                            <input type="text" id="add-author" required placeholder="Nome do autor" style="font-size: 0.9rem; padding: 0.5rem;">
                        </div>
                        <div class="form-group" style="margin-bottom: 0.6rem;">
                            <label for="add-category" style="font-size: 0.85rem; margin-bottom: 0.25rem; display: block;">Categoria:</label>
                            <input type="text" id="add-category" placeholder="Ex: Fic√ß√£o, Romance, etc." style="font-size: 0.9rem; padding: 0.5rem;">
                        </div>
                        <div class="form-group" style="margin-bottom: 0.6rem;">
                            <label for="add-isbn" style="font-size: 0.85rem; margin-bottom: 0.25rem; display: block;">ISBN:</label>
                            <input type="text" id="add-isbn" required placeholder="C√≥digo ISBN (10 ou 13 d√≠gitos)" style="font-size: 0.9rem; padding: 0.5rem;">
                        </div>
                        <button type="submit" style="margin-top: 0.4rem; width: 100%; padding: 0.65rem; font-size: 0.9rem;">Adicionar Livro</button>
                    </form>

                    <!-- Bot√£o Editar Livro -->
                    <div style="margin-top: 0.8rem;">
                        <button id="open-edit-book-modal" type="button" style="width: 100%; padding: 0.6rem; background: linear-gradient(135deg, #4299e1, #3182ce); color: white; border: none; border-radius: 6px; font-weight: 600; font-size: 0.85rem; cursor: pointer; transition: all 0.2s ease;">
                            ‚úèÔ∏è Editar Livro
                        </button>
                    </div>
                </div>

                <!-- Coluna Direita: Estat√≠sticas -->
                <div class="form-card" style="padding: 1.2rem;">
                    <h2 style="margin-bottom: 1rem; color: #2c5282; font-size: 1.3rem;">üìä Estat√≠sticas do Sistema</h2>
                    
                    <!-- Cards de estat√≠sticas -->
                    <div style="display: grid; grid-template-columns: repeat(2, 1fr); gap: 1rem; margin-bottom: 1rem;">
                        <div style="padding: 1.2rem; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); border-radius: 8px; color: white; box-shadow: 0 4px 12px rgba(102, 126, 234, 0.3);">
                            <div style="font-size: 0.8rem; font-weight: 600; opacity: 0.9; margin-bottom: 0.4rem;">üìö Total de Livros</div>
                            <div style="font-size: 2.2rem; font-weight: 700;" id="total-books-count">0</div>
                        </div>
                        <div style="padding: 1.2rem; background: linear-gradient(135deg, #48bb78 0%, #38a169 100%); border-radius: 8px; color: white; box-shadow: 0 4px 12px rgba(72, 187, 120, 0.3);">
                            <div style="font-size: 0.8rem; font-weight: 600; opacity: 0.9; margin-bottom: 0.4rem;">‚úì Dispon√≠veis</div>
                            <div style="font-size: 2.2rem; font-weight: 700;" id="available-books-count">0</div>
                        </div>
                        <div style="padding: 1.2rem; background: linear-gradient(135deg, #f6ad55 0%, #ed8936 100%); border-radius: 8px; color: white; box-shadow: 0 4px 12px rgba(246, 173, 85, 0.3);">
                            <div style="font-size: 0.8rem; font-weight: 600; opacity: 0.9; margin-bottom: 0.4rem;">‚è∞ Emprestados</div>
                            <div style="font-size: 2.2rem; font-weight: 700;" id="borrowed-books-count">0</div>
                        </div>
                        <div style="padding: 1.2rem; background: linear-gradient(135deg, #4299e1 0%, #3182ce 100%); border-radius: 8px; color: white; box-shadow: 0 4px 12px rgba(66, 153, 225, 0.3);">
                            <div style="font-size: 0.8rem; font-weight: 600; opacity: 0.9; margin-bottom: 0.4rem;">üë• Alunos</div>
                            <div style="font-size: 2.2rem; font-weight: 700;" id="total-students-count">0</div>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Bot√£o de Logout (fixo no canto inferior direito) -->
            <a href="/logout" class="btn-logout-bottom" title="Sair do sistema">
                üö™ Sair
            </a>
        </div>

        <!-- Nova aba: Gerenciar Alunos -->
        <div id="manage-students" class="tab-content">
            <div style="display: grid; grid-template-columns: 340px 1fr; gap: 1.5rem; align-items: start; max-height: calc(100vh - 180px);">
                <!-- Coluna Esquerda: Formul√°rio de Adicionar -->
                <div class="form-card" style="padding: 1.5rem;">
                    <h3 style="margin-bottom: 1.25rem; color: #2c5282; font-size: 1.2rem;">‚ûï Adicionar Aluno:</h3>
                    
                    <button id="open-add-student-modal-btn" style="width: 100%; padding: 0.85rem; font-size: 1rem; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; border: none; border-radius: 8px; cursor: pointer; font-weight: 600; transition: all 0.3s ease; box-shadow: 0 4px 12px rgba(102, 126, 234, 0.3);">
                        ‚ûï Novo Aluno
                    </button>
                </div>

                <!-- Coluna Direita: Lista de Alunos -->
                <div class="form-card" style="padding: 1.5rem; max-height: calc(100vh - 180px); overflow: hidden; display: flex; flex-direction: column;">
                    <!-- Cabe√ßalho centralizado -->
                    <div style="text-align: center; margin-bottom: 0.75rem; padding-bottom: 0.5rem; border-bottom: 2px solid #e2e8f0;">
                        <h3 style="margin: 0; color: #2c5282; font-size: 1.1rem; display: inline-flex; align-items: center; gap: 0.4rem;">
                            üìã Lista de Alunos:
                            <span id="students-count-badge" class="count-badge" title="Total de alunos cadastrados">0</span>
                        </h3>
                    </div>

                    <!-- Filtros -->
                    <div style="display: flex; justify-content: center; align-items: center; margin-bottom: 0.75rem; gap: 0.75rem;">
                        <select id="filter-turma" style="padding: 0.6rem; border: 1px solid #cbd5e0; border-radius: 6px; font-size: 0.9rem; min-width: 140px; background: white; cursor: pointer;">
                            <option value="">Todas as Turmas</option>
                            <option value="Turma 1">üìö Turma 1</option>
                            <option value="Turma 2">üìö Turma 2</option>
                            <option value="Turma 3">üìö Turma 3</option>
                        </select>
                        <div class="autocomplete-wrapper" style="max-width: 350px; min-width: 280px;">
                            <input type="text" id="search-students" class="section-search" placeholder="Buscar aluno..." autocomplete="off" style="margin-bottom: 0;">
                            <div id="students-search-dropdown" class="autocomplete-list" style="display:none;"></div>
                        </div>
                    </div>
                    
                    <div class="students-grid-header" style="padding: 0.75rem; font-size: 0.85rem;">
                        <span>üë§ Nome</span>
                        <span>üìÖ Data de Cadastro</span>
                        <span>‚öôÔ∏è A√ß√µes</span>
                    </div>
                    <div id="students-grid" class="students-grid" style="max-height: calc(100vh - 400px); overflow-y: auto;">
                        <div class="loader">Carregando alunos...</div>
                    </div>
                </div>
            </div>
        </div>

        <div id="available-books" class="tab-content">
            <div class="section-header">
                <div class="section-title">
                    <h2>Livros Dispon√≠veis: <span id="available-count-badge" class="count-badge-inline" title="N√∫mero de livros dispon√≠veis">0</span></h2>
                </div>
                <div class="controls-right">
                    <input type="text" id="search-books" class="section-search" placeholder="Pesquisar livros...">
                </div>
            </div>
            <div class="book-grid-header">
                <span>T√≠tulo</span>
                <span>Autor</span>
                <span>Categoria</span>
                <span>ISBN</span>
                <span>Status</span>
                <span>A√ß√µes</span>
            </div>
            <div id="book-grid" class="book-grid"></div>
        </div>

        <div id="borrowed-books" class="tab-content">
            <div class="section-header">
                <div class="section-title">
                    <h2>Livros Emprestados: <span id="borrowed-count-badge" class="count-badge-inline" title="N√∫mero de livros emprestados">0</span></h2>
                </div>
                <div class="controls-right">
                    <input type="text" id="search-borrowed" class="section-search" placeholder="Pesquisar livros emprestados...">
                </div>
            </div>
            <div class="book-grid-header">
                <span>T√≠tulo</span>
                <span>Autor</span>
                <span>Categoria</span>
                <span>ISBN</span>
                <span>Informa√ß√µes de Empr√©stimo</span>
            </div>
            <div id="borrowed-grid" class="book-grid"></div>
        </div>

        <div id="history" class="tab-content">
            <!-- Layout de 2 colunas: Filtros √† esquerda, Lista √† direita -->
            <div class="history-main-grid">
                <!-- Coluna de Filtros e Controles -->
                <aside class="history-sidebar">
                    <!-- Bot√£o para abrir Estat√≠sticas -->
                    <button id="open-stats-modal" class="btn-open-stats" title="Ver estat√≠sticas do sistema">
                        üìä Ver Estat√≠sticas
                    </button>

                    <!-- Card de Filtros Compacto -->
                    <div class="history-filters-card compact-filters">
                        <button class="filter-toggle" id="filter-toggle" aria-expanded="false" type="button">
                            <span class="filter-toggle-content">
                                <span class="filter-icon">üîç</span>
                                <span class="filter-title">Filtros</span>
                                <span class="filter-badge" id="active-filters-count"></span>
                            </span>
                            <span class="filter-arrow">‚ñº</span>
                        </button>
                        
                        <div class="filters-content" id="filters-content">
                            <!-- Pesquisa r√°pida -->
                            <div class="filter-group compact search-filter">
                                <label for="search-history">Pesquisar</label>
                                <input type="text" id="search-history" placeholder="T√≠tulo, autor ou ISBN..." aria-label="Pesquisar hist√≥rico">
                            </div>

                            <!-- Grade de filtros compacta -->
                            <div class="filters-grid">
                                <div class="filter-group compact">
                                    <label for="filter-type">Tipo</label>
                                    <select id="filter-type" aria-label="Filtrar por tipo">
                                        <option value="all">Todas</option>
                                        <option value="added">üìö Adicionados</option>
                                        <option value="borrowed">üìñ Emprestados</option>
                                        <option value="returned">‚úÖ Devolvidos</option>
                                    </select>
                                </div>

                                <div class="filter-group compact">
                                    <label for="filter-category">Categoria</label>
                                    <select id="filter-category" aria-label="Filtrar por categoria">
                                        <option value="all">Todas</option>
                                    </select>
                                </div>

                                <div class="filter-group compact">
                                    <label for="sort-by">Ordenar</label>
                                    <select id="sort-by" aria-label="Ordenar por">
                                        <option value="newest">Recentes</option>
                                        <option value="oldest">Antigos</option>
                                        <option value="title">A-Z</option>
                                    </select>
                                </div>
                            </div>

                            <!-- Filtro de per√≠odo -->
                            <div class="filter-group compact period-filter">
                                <div class="date-range-compact">
                                    <input type="date" id="from-date" aria-label="Data in√≠cio">
                                    <span>‚Üí</span>
                                    <input type="date" id="to-date" aria-label="Data fim">
                                </div>
                            </div>

                            <button id="clear-filters" class="btn-clear-filters compact" type="button">
                                <span>üîÑ</span> Limpar Filtros
                            </button>
                        </div>
                    </div>

                    <!-- Card de Exporta√ß√£o -->
                    <div class="history-export-card">
                        <h3 style="margin: 0 0 0.8rem 0; font-size: 0.95rem; color: #1a365d; display: flex; align-items: center; gap: 0.5rem;">
                            <span>üíæ</span> Exportar
                        </h3>
                        
                        <div class="filter-group compact">
                            <label for="export-scope">Escopo</label>
                            <select id="export-scope" title="Escopo da exporta√ß√£o">
                                <option value="filtered">Filtrados</option>
                                <option value="page">P√°gina atual</option>
                                <option value="all">Tudo</option>
                            </select>
                        </div>

                        <div class="export-buttons">
                            <button id="export-to-docs" class="btn-export btn-export-docs" title="Exportar para docs">
                                ÔøΩ Exportar CSV
                            </button>
                        </div>
                    </div>
                </aside>

                <!-- Coluna Principal: Lista de Hist√≥rico -->
                <main class="history-main-content">
                    <div class="history-header">
                        <div class="history-title-section">
                            <h2 style="margin: 0; font-size: 1.2rem; color: #1a365d;">üìã Registros</h2>
                            <div class="section-title" style="margin-left: 1rem;">
                                Total: <span id="summary-count" class="count-badge">0</span>
                            </div>
                        </div>
                        <button id="load-more" class="btn-load-more" style="display:none;">Carregar mais</button>
                    </div>

                    <div id="history-list" class="history-list-modern" aria-live="polite"></div>
                </main>
            </div>

            <!-- Modal de Estat√≠sticas -->
            <div id="stats-modal" class="modal" aria-hidden="true">
                <div class="modal-content stats-modal-content" role="dialog" aria-modal="true" aria-labelledby="stats-modal-title">
                    <header class="modal-header stats-modal-header">
                        <h2 id="stats-modal-title" style="display: flex; align-items: center; gap: 0.5rem; margin: 0;">
                            üìä Estat√≠sticas do Sistema
                        </h2>
                        <button class="modal-close stats-modal-close" id="stats-modal-close" aria-label="Fechar">√ó</button>
                    </header>
                    <div class="modal-body stats-modal-body">
                        <!-- Grid de Cards de Estat√≠sticas -->
                        <div class="stats-modal-grid">
                            <div class="stat-card-modal stat-card-added">
                                <div class="stat-card-header">
                                    <div class="stat-icon-modal">üìö</div>
                                    <div class="stat-label-modal">Livros Adicionados</div>
                                </div>
                                <div class="stat-value-modal" id="stat-added">0</div>
                                <div class="stat-description">Total de livros no sistema</div>
                            </div>
                            
                            <div class="stat-card-modal stat-card-borrowed">
                                <div class="stat-card-header">
                                    <div class="stat-icon-modal">üìñ</div>
                                    <div class="stat-label-modal">Emprestados</div>
                                </div>
                                <div class="stat-value-modal" id="stat-borrowed">0</div>
                                <div class="stat-description">Livros atualmente emprestados</div>
                            </div>
                            
                            <div class="stat-card-modal stat-card-returned">
                                <div class="stat-card-header">
                                    <div class="stat-icon-modal">‚úÖ</div>
                                    <div class="stat-label-modal">Devolvidos</div>
                                </div>
                                <div class="stat-value-modal" id="stat-returned">0</div>
                                <div class="stat-description">Total de devolu√ß√µes registradas</div>
                            </div>
                        </div>

                        <!-- Informa√ß√µes Adicionais -->
                        <div class="stats-info-section">
                            <h3 style="margin: 0 0 1rem 0; font-size: 1rem; color: #1a365d; display: flex; align-items: center; gap: 0.5rem;">
                                üìà Vis√£o Geral
                            </h3>
                            <div class="stats-summary-grid">
                                <div class="summary-item">
                                    <span class="summary-label">Taxa de Empr√©stimo</span>
                                    <span class="summary-value" id="loan-rate">0%</span>
                                </div>
                                <div class="summary-item">
                                    <span class="summary-label">Taxa de Devolu√ß√£o</span>
                                    <span class="summary-value" id="return-rate">0%</span>
                                </div>
                            </div>
                        </div>

                        <!-- Rodap√© do Modal -->
                        <div class="stats-modal-footer">
                            <p style="margin: 0; text-align: center; color: #718096; font-size: 0.85rem;">
                                üí° Dados atualizados em tempo real
                            </p>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Modal para detalhes do livro -->
        <div id="book-details-modal" class="modal">
            <div class="modal-content">
                <span id="close-details-modal" class="close-btn">√ó</span>
                <h2>Detalhes do Livro</h2>
                <p id="details-title"></p>
                <p id="details-author"></p>
                <p id="details-category"></p>
                <p id="details-isbn"></p>
                <p id="details-status"></p>
            </div>
        </div>

        <!-- Modal para devolu√ß√£o (existente, para multas) -->
        <div id="return-modal" class="modal">
            <div class="modal-content">
                <span id="close-return-modal" class="close-btn">√ó</span>
                <h2>Devolu√ß√£o Realizada</h2>
                <p id="modal-book-title"></p>
                <p id="modal-return-date"></p>
                <p id="modal-fine"></p>
            </div>
        </div>

        <!-- Modal para empr√©stimo -->
        <div id="borrow-modal" class="modal" aria-hidden="true">
            <div class="modal-content">
                <header class="modal-header">
                    <h2>Emprestar Livro</h2>
                    <button id="close-borrow-modal" class="close-btn" aria-label="Fechar">√ó</button>
                </header>
                <div class="modal-body">
                    <p id="borrow-title" class="muted"></p>
                    <p id="borrow-author" class="muted"></p>
                    <p id="borrow-isbn" class="muted"></p>
                    <div class="form-group">
                        <label for="borrow-student-input">Buscar e Selecionar Aluno</label>
                        <div class="autocomplete-wrapper">
                            <input type="text" id="borrow-student-input" autocomplete="off" placeholder="Digite o nome do aluno..." required>
                            <input type="hidden" id="borrow-student-value">
                            <div id="borrow-student-list" class="autocomplete-list" style="display:none;"></div>
                        </div>
                        <p class="muted" style="margin-top:0.5rem;font-size:0.9rem;">Digite para buscar. Apenas alunos cadastrados podem emprestar livros.</p>
                    </div>
                </div>
                <footer class="modal-footer">
                    <button id="cancel-borrow-btn" class="btn secondary">Cancelar</button>
                    <button id="confirm-borrow-btn" class="btn primary" data-action="confirm-borrow">Emprestar</button>
                </footer>
            </div>
        </div>

        <!-- Modal para confirmar devolu√ß√£o -->
        <div id="return-confirm-modal" class="modal" aria-hidden="true">
            <div class="modal-content">
                <header class="modal-header">
                    <h2>Confirmar Devolu√ß√£o</h2>
                    <button id="close-return-confirm-modal" class="close-btn" aria-label="Fechar">√ó</button>
                </header>
                <div class="modal-body">
                    <p id="return-title" class="muted"></p>
                    <p id="return-author" class="muted"></p>
                    <p id="return-isbn" class="muted"></p>
                    <p id="return-student-name" class="muted"></p>
                    <p id="return-borrow-date" class="muted"></p>
                    <p id="return-expected-date" class="muted"></p>
                    <p id="return-fine" class="muted"></p>
                </div>
                <footer class="modal-footer">
                    <button id="cancel-return-btn" class="btn secondary">Cancelar</button>
                    <button id="confirm-return-btn" class="btn primary">Confirmar Devolu√ß√£o</button>
                </footer>
            </div>
        </div>

        <div id="notification-container"></div>
    </div>

    <!-- Modal para edi√ß√£o de livro -->
    <div id="edit-book-modal" class="modal" aria-hidden="true">
        <div class="modal-content" role="dialog" aria-modal="true" aria-labelledby="edit-book-modal-title" style="max-width: 600px; width: 90%;">
            <header class="modal-header" style="background: linear-gradient(135deg, #4299e1, #3182ce); color: white; padding: 1.2rem 1.5rem; border-radius: 12px 12px 0 0; display: flex; justify-content: space-between; align-items: center; margin: -1.5rem -1.5rem 0 -1.5rem;">
                <h2 id="edit-book-modal-title" style="margin: 0; font-size: 1.3rem; font-weight: 700; display: flex; align-items: center; gap: 0.5rem;">
                    <span style="font-size: 1.5rem;">‚úèÔ∏è</span>
                    <span>Editar Livro</span>
                </h2>
                <button class="modal-close" id="edit-book-modal-close" aria-label="Fechar" style="background: rgba(255, 255, 255, 0.2); color: white; border: none; width: 36px; height: 36px; border-radius: 50%; font-size: 1.5rem; cursor: pointer; transition: all 0.3s ease; display: flex; align-items: center; justify-content: center; line-height: 1;">√ó</button>
            </header>
            <div class="modal-body" style="padding: 1.5rem;">
                <!-- Buscar livro -->
                <div class="form-group" style="margin-bottom: 1rem;">
                    <label for="search-book-edit" style="font-size: 0.9rem; font-weight: 600; margin-bottom: 0.5rem; display: block;">üîç Buscar Livro:</label>
                    <input type="text" id="search-book-edit" placeholder="Digite t√≠tulo, autor ou ISBN..." style="width: 100%; padding: 0.7rem; border: 2px solid #e2e8f0; border-radius: 6px; font-size: 0.9rem;">
                    <p style="margin: 0.4rem 0 0 0; font-size: 0.8rem; color: #718096;">Digite para buscar o livro que deseja editar</p>
                </div>

                <!-- Lista de resultados da busca -->
                <div id="search-results-edit" style="max-height: 200px; overflow-y: auto; margin-bottom: 1rem; border: 1px solid #e2e8f0; border-radius: 6px; display: none;"></div>

                <!-- Formul√°rio de edi√ß√£o (inicialmente oculto) -->
                <div id="edit-form-container" style="display: none;">
                    <div style="padding: 1rem; background: #f7fafc; border-radius: 6px; margin-bottom: 1rem;">
                        <h3 style="margin: 0 0 0.5rem 0; font-size: 0.95rem; color: #2d3748;">Editando: <span id="editing-book-title" style="color: #4299e1; font-weight: 700;"></span></h3>
                        <input type="hidden" id="edit-book-id">
                    </div>

                    <form id="edit-book-form">
                        <div class="form-group" style="margin-bottom: 0.8rem;">
                            <label for="edit-title" style="font-size: 0.85rem; font-weight: 600; margin-bottom: 0.3rem; display: block;">T√≠tulo:</label>
                            <input type="text" id="edit-title" required placeholder="T√≠tulo do livro" style="width: 100%; padding: 0.6rem; border: 1.5px solid #e2e8f0; border-radius: 6px; font-size: 0.9rem;">
                        </div>

                        <div class="form-group" style="margin-bottom: 0.8rem;">
                            <label for="edit-author" style="font-size: 0.85rem; font-weight: 600; margin-bottom: 0.3rem; display: block;">Autor:</label>
                            <input type="text" id="edit-author" required placeholder="Nome do autor" style="width: 100%; padding: 0.6rem; border: 1.5px solid #e2e8f0; border-radius: 6px; font-size: 0.9rem;">
                        </div>

                        <div class="form-group" style="margin-bottom: 0.8rem;">
                            <label for="edit-category" style="font-size: 0.85rem; font-weight: 600; margin-bottom: 0.3rem; display: block;">Categoria:</label>
                            <input type="text" id="edit-category" placeholder="Categoria do livro" style="width: 100%; padding: 0.6rem; border: 1.5px solid #e2e8f0; border-radius: 6px; font-size: 0.9rem;">
                        </div>

                        <div class="form-group" style="margin-bottom: 0.8rem;">
                            <label for="edit-isbn" style="font-size: 0.85rem; font-weight: 600; margin-bottom: 0.3rem; display: block;">ISBN:</label>
                            <input type="text" id="edit-isbn" required placeholder="ISBN do livro" style="width: 100%; padding: 0.6rem; border: 1.5px solid #e2e8f0; border-radius: 6px; font-size: 0.9rem;">
                        </div>

                        <div style="display: flex; gap: 0.8rem; margin-top: 1.2rem;">
                            <button type="button" id="cancel-edit-btn" style="flex: 1; padding: 0.7rem; background: #e2e8f0; color: #4a5568; border: none; border-radius: 6px; font-weight: 600; cursor: pointer;">Cancelar</button>
                            <button type="submit" style="flex: 1; padding: 0.7rem; background: linear-gradient(135deg, #48bb78, #38a169); color: white; border: none; border-radius: 6px; font-weight: 600; cursor: pointer;">üíæ Salvar Altera√ß√µes</button>
                        </div>
                    </form>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal para exclus√£o de livro -->
    <div id="delete-modal" class="modal" aria-hidden="true">
        <div class="modal-content" style="max-width: 500px; width: 90%;">
            <header class="modal-header" style="background: linear-gradient(135deg, #f56565, #e53e3e); color: white; padding: 1.2rem 1.5rem; border-radius: 12px 12px 0 0; display: flex; justify-content: space-between; align-items: center; margin: -1.5rem -1.5rem 0 -1.5rem;">
                <h2 style="margin: 0; font-size: 1.3rem; font-weight: 700; display: flex; align-items: center; gap: 0.5rem;">
                    <span style="font-size: 1.5rem;">üóëÔ∏è</span>
                    <span>Excluir Livro</span>
                </h2>
                <button id="close-delete-modal" class="close-btn" aria-label="Fechar" style="background: rgba(255, 255, 255, 0.2); color: white; border: none; width: 36px; height: 36px; border-radius: 50%; font-size: 1.5rem; cursor: pointer; transition: all 0.3s ease; display: flex; align-items: center; justify-content: center; line-height: 1;">√ó</button>
            </header>
            <div class="modal-body" style="padding: 1.5rem;">
                <p id="delete-modal-text" style="margin: 0 0 0.8rem 0; font-size: 0.95rem; color: #2d3748;">Tem certeza que deseja excluir este livro? Esta a√ß√£o n√£o pode ser desfeita.</p>
                <p id="delete-modal-book" class="muted"></p>
            </div>
            <footer class="modal-footer" style="padding: 1rem 1.5rem; background: #f7fafc; border-radius: 0 0 12px 12px; margin: 0 -1.5rem -1.5rem -1.5rem; display: flex; gap: 0.8rem; justify-content: flex-end;">
                <button id="cancel-delete-btn" class="btn secondary" style="padding: 0.7rem 1.5rem; background: #e2e8f0; color: #4a5568; border: none; border-radius: 6px; font-weight: 600; cursor: pointer;">Cancelar</button>
                <button id="confirm-delete-btn" class="btn primary" style="padding: 0.7rem 1.5rem; background: linear-gradient(135deg, #f56565, #e53e3e); color: white; border: none; border-radius: 6px; font-weight: 600; cursor: pointer;">Excluir</button>
            </footer>
        </div>
    </div>

    <!-- Modal para adicionar aluno -->
    <div id="add-student-modal" class="modal" aria-hidden="true">
        <div class="modal-content" role="dialog" aria-modal="true" aria-labelledby="add-student-modal-title" style="max-width: 550px; width: 90%;">
            <header class="modal-header" style="background: linear-gradient(135deg, #4299e1, #3182ce); color: white; padding: 1.2rem 1.5rem; border-radius: 12px 12px 0 0; display: flex; justify-content: space-between; align-items: center; margin: -1.5rem -1.5rem 0 -1.5rem;">
                <h2 id="add-student-modal-title" style="margin: 0; font-size: 1.3rem; font-weight: 700; display: flex; align-items: center; gap: 0.5rem;">
                    <span style="font-size: 1.5rem;">‚ûï</span>
                    <span>Adicionar Aluno</span>
                </h2>
                <button id="close-add-student-modal" class="close-btn" aria-label="Fechar" style="background: rgba(255, 255, 255, 0.2); color: white; border: none; width: 36px; height: 36px; border-radius: 50%; font-size: 1.5rem; cursor: pointer; transition: all 0.3s ease; display: flex; align-items: center; justify-content: center; line-height: 1;">√ó</button>
            </header>
            <div class="modal-body" style="padding: 1.5rem;">
                <form id="add-student-modal-form">
                    <div class="form-group" style="margin-bottom: 1rem;">
                        <label for="add-student-modal-name" style="font-size: 0.9rem; font-weight: 600; margin-bottom: 0.5rem; display: block;">Nome Completo:</label>
                        <input type="text" id="add-student-modal-name" required placeholder="Digite o nome completo" style="width: 100%; padding: 0.7rem; border: 2px solid #e2e8f0; border-radius: 6px; font-size: 0.9rem;">
                    </div>
                    <div class="form-group" style="margin-bottom: 0.5rem;">
                        <label for="add-student-modal-turma" style="font-size: 0.9rem; font-weight: 600; margin-bottom: 0.5rem; display: block;">Turma:</label>
                        <select id="add-student-modal-turma" required style="width: 100%; padding: 0.7rem; border: 2px solid #e2e8f0; border-radius: 6px; font-size: 0.9rem; cursor: pointer; background: white;">
                            <option value="">Carregando turmas...</option>
                        </select>
                    </div>
                </form>
            </div>
            <footer class="modal-footer" style="background: #f7fafc; padding: 1rem 1.5rem; border-radius: 0 0 12px 12px; margin: 0 -1.5rem -1.5rem -1.5rem; display: flex; justify-content: flex-end; gap: 0.75rem;">
                <button id="cancel-add-student-btn" class="btn secondary" style="padding: 0.65rem 1.25rem; font-size: 0.9rem; background: #e2e8f0; color: #2d3748; border: none; border-radius: 6px; cursor: pointer; font-weight: 600; transition: all 0.2s;">Cancelar</button>
                <button id="confirm-add-student-btn" class="btn primary" style="padding: 0.65rem 1.25rem; font-size: 0.9rem; background: #4299e1; color: white; border: none; border-radius: 6px; cursor: pointer; font-weight: 600; transition: all 0.2s;">Adicionar Aluno</button>
            </footer>
        </div>
    </div>

    <!-- Modal para editar aluno -->
    <div id="edit-student-modal" class="modal" aria-hidden="true">
        <div class="modal-content" role="dialog" aria-modal="true" aria-labelledby="edit-student-modal-title" style="max-width: 550px; width: 90%;">
            <header class="modal-header" style="background: linear-gradient(135deg, #4299e1, #3182ce); color: white; padding: 1.2rem 1.5rem; border-radius: 12px 12px 0 0; display: flex; justify-content: space-between; align-items: center; margin: -1.5rem -1.5rem 0 -1.5rem;">
                <h2 id="edit-student-modal-title" style="margin: 0; font-size: 1.3rem; font-weight: 700; display: flex; align-items: center; gap: 0.5rem;">
                    <span style="font-size: 1.5rem;">‚úèÔ∏è</span>
                    <span>Editar Aluno</span>
                </h2>
                <button id="close-edit-student-modal" class="close-btn" aria-label="Fechar" style="background: rgba(255, 255, 255, 0.2); color: white; border: none; width: 36px; height: 36px; border-radius: 50%; font-size: 1.5rem; cursor: pointer; transition: all 0.3s ease; display: flex; align-items: center; justify-content: center; line-height: 1;">√ó</button>
            </header>
            <div class="modal-body" style="padding: 1.5rem;">
                <form id="edit-student-form">
                    <div class="form-group" style="margin-bottom: 1rem;">
                        <label for="edit-student-name" style="font-size: 0.9rem; font-weight: 600; margin-bottom: 0.5rem; display: block;">Nome Completo:</label>
                        <input type="text" id="edit-student-name" required placeholder="Digite o nome completo" style="width: 100%; padding: 0.7rem; border: 2px solid #e2e8f0; border-radius: 6px; font-size: 0.9rem;">
                    </div>
                    <div class="form-group" style="margin-bottom: 0.5rem;">
                        <label for="edit-student-turma" style="font-size: 0.9rem; font-weight: 600; margin-bottom: 0.5rem; display: block;">Turma:</label>
                        <select id="edit-student-turma" required style="width: 100%; padding: 0.7rem; border: 2px solid #e2e8f0; border-radius: 6px; font-size: 0.9rem; cursor: pointer; background: white;">
                            <option value="">Carregando turmas...</option>
                        </select>
                    </div>
                    <input type="hidden" id="edit-student-id">
                </form>
            </div>
            <footer class="modal-footer" style="background: #f7fafc; padding: 1rem 1.5rem; border-radius: 0 0 12px 12px; margin: 0 -1.5rem -1.5rem -1.5rem; display: flex; justify-content: flex-end; gap: 0.75rem;">
                <button id="cancel-edit-student-btn" class="btn secondary" style="padding: 0.65rem 1.25rem; font-size: 0.9rem; background: #e2e8f0; color: #2d3748; border: none; border-radius: 6px; cursor: pointer; font-weight: 600; transition: all 0.2s;">Cancelar</button>
                <button id="confirm-edit-student-btn" class="btn primary" style="padding: 0.65rem 1.25rem; font-size: 0.9rem; background: #4299e1; color: white; border: none; border-radius: 6px; cursor: pointer; font-weight: 600; transition: all 0.2s;">Salvar Altera√ß√µes</button>
            </footer>
        </div>
    </div>

    <!-- Modal para excluir aluno -->
    <div id="delete-student-modal" class="modal" aria-hidden="true">
        <div class="modal-content" style="max-width: 500px; width: 90%;">
            <header class="modal-header" style="background: linear-gradient(135deg, #f56565, #e53e3e); color: white; padding: 1.2rem 1.5rem; border-radius: 12px 12px 0 0; display: flex; justify-content: space-between; align-items: center; margin: -1.5rem -1.5rem 0 -1.5rem;">
                <h2 style="margin: 0; font-size: 1.3rem; font-weight: 700; display: flex; align-items: center; gap: 0.5rem;">
                    <span style="font-size: 1.5rem;">üóëÔ∏è</span>
                    <span>Excluir Aluno</span>
                </h2>
                <button id="close-delete-student-modal" class="close-btn" aria-label="Fechar" style="background: rgba(255, 255, 255, 0.2); color: white; border: none; width: 36px; height: 36px; border-radius: 50%; font-size: 1.5rem; cursor: pointer; transition: all 0.3s ease; display: flex; align-items: center; justify-content: center; line-height: 1;">√ó</button>
            </header>
            <div class="modal-body" style="padding: 1.5rem;">
                <p id="delete-student-modal-text" style="margin: 0 0 0.8rem 0; font-size: 0.95rem; color: #2d3748;">Tem certeza que deseja excluir este aluno? Esta a√ß√£o n√£o pode ser desfeita.</p>
                <p id="delete-student-modal-name" class="muted" style="font-weight: 600; color: #e53e3e; margin-top: 1rem;"></p>
                <input type="hidden" id="delete-student-id">
            </div>
            <footer class="modal-footer" style="padding: 1rem 1.5rem; background: #f7fafc; border-radius: 0 0 12px 12px; margin: 0 -1.5rem -1.5rem -1.5rem; display: flex; gap: 0.8rem; justify-content: flex-end;">
                <button id="cancel-delete-student-btn" class="btn secondary" style="padding: 0.7rem 1.5rem; background: #e2e8f0; color: #4a5568; border: none; border-radius: 6px; font-weight: 600; cursor: pointer;">Cancelar</button>
                <button id="confirm-delete-student-btn" class="btn primary" style="padding: 0.7rem 1.5rem; background: linear-gradient(135deg, #f56565, #e53e3e); color: white; border: none; border-radius: 6px; font-weight: 600; cursor: pointer;">Excluir</button>
            </footer>
        </div>
    </div>

    <script src="/static/notify.js?v=10"></script>
    <script src="/static/script.js?v=36"></script>
    <script src="/static/edit-book.js?v=11"></script>
    <script src="/static/history.js?v=19"></script>
<script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'94dad69b2c8bf231',t:'MTc0OTU3OTE2MS4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script></body>
</html>  